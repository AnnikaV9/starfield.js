<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="An interactive starfield background with html canvas">
  <title>starfield.js</title>
</head>
<body>
  <link rel="stylesheet" href="css/main.css">
  <div class="starfield">
    <p class="starfield-origin">Hover me!</p>
  </div>
  <div class="title-text">starfield.js</div>
  <div class="github-icon">
    <a href="https://github.com/AnnikaV9/starfield.js" target="_blank" title="View on GitHub"></a>
  </div>
  <div class="config-panel">
    <div class="config-panel-header">
        <span>Configuration</span>
        <button id="toggle-config-panel" title="Minimize Panel">−</button>
    </div>
    <div class="config-content">
      <br>

      <label for="starColor">Star Color</label>
      <input type="color" id="starColor" value="#ffffff">

      <label for="trailLength">Trail Length</label>
      <input type="number" id="trailLength" min="0" max="0.8" step="0.1" value="0.8">

      <label for="baseSpeed">Base Speed</label>
      <input type="number" id="baseSpeed" min="0.1" max="10" step="0.1" value="1">

      <label for="maxAcceleration">Max Acceleration</label>
      <input type="number" id="maxAcceleration" min="1" max="50" step="1" value="10">

      <label for="accelerationRate">Acceleration Rate</label>
      <input type="number" id="accelerationRate" min="0.1" max="5" step="0.1" value="0.2">

      <label for="decelerationRate">Deceleration Rate</label>
      <input type="number" id="decelerationRate" min="0.1" max="5" step="0.1" value="0.2">

      <label for="minSpawnRadius">Min Spawn Radius</label>
      <input type="number" id="minSpawnRadius" min="10" max="500" step="10" value="80">

      <label for="maxSpawnRadius">Max Spawn Radius</label>
      <input type="number" id="maxSpawnRadius" min="50" max="1000" step="10" value="500">
    </div>
  </div>
  <script src="js/starfield.min.js"></script>
  <script>
    console.log('starfield.js loaded');
    Starfield.setup();

    const updateConfig = {
      trailLength: (value) => {
        if (value === "") return;
        Starfield.config.trailLength = parseFloat(value);
      },
      starColor: (value) => {
        const numericValue = parseInt(value.replace("#", ""), 16);
        const r = (numericValue >> 16) & 0xFF;
        const g = (numericValue >> 8) & 0xFF;
        const b = numericValue & 0xFF;
        Starfield.config.starColor = `rgb(${r}, ${g}, ${b})`;
      },
      baseSpeed: (value) => {
        if (value === "") return;
        Starfield.config.baseSpeed = parseFloat(value);
      },
      maxAcceleration: (value) => {
        if (value === "") return;
        Starfield.config.maxAcceleration = parseFloat(value);
      },
      accelerationRate: (value) => {
        if (value === "") return;
        Starfield.config.accelerationRate = parseFloat(value);
      },
      decelerationRate: (value) => {
        if (value === "") return;
        Starfield.config.decelerationRate = parseFloat(value);
      },
      minSpawnRadius: (value) => {
        if (value === "") return;
        Starfield.config.minSpawnRadius = parseInt(value, 10);
      },
      maxSpawnRadius: (value) => {
        if (value === "") return;
        Starfield.config.maxSpawnRadius = parseInt(value, 10);
      },
    };

    const attachDynamicListeners = () => {
      document.getElementById('trailLength').addEventListener('input', (e) => updateConfig.trailLength(e.target.value));
      document.getElementById('starColor').addEventListener('input', (e) => updateConfig.starColor(e.target.value));
      document.getElementById('baseSpeed').addEventListener('input', (e) => updateConfig.baseSpeed(e.target.value));
      document.getElementById('maxAcceleration').addEventListener('input', (e) => updateConfig.maxAcceleration(e.target.value));
      document.getElementById('accelerationRate').addEventListener('input', (e) => updateConfig.accelerationRate(e.target.value));
      document.getElementById('decelerationRate').addEventListener('input', (e) => updateConfig.decelerationRate(e.target.value));
      document.getElementById('minSpawnRadius').addEventListener('input', (e) => updateConfig.minSpawnRadius(e.target.value));
      document.getElementById('maxSpawnRadius').addEventListener('input', (e) => updateConfig.maxSpawnRadius(e.target.value));
    };

    attachDynamicListeners();

    document.getElementById('toggle-config-panel').addEventListener('click', function () {
      const configPanel = document.querySelector('.config-panel');
      const toggleButton = document.getElementById('toggle-config-panel');
      configPanel.classList.toggle('minimized');

      if (configPanel.classList.contains('minimized')) {
        toggleButton.textContent = '+';
        toggleButton.title = 'Maximize Panel';
      } else {
        toggleButton.textContent = '−';
        toggleButton.title = 'Minimize Panel';
      }
    });
  </script>
</body>
</html>
